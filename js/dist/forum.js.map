{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@xypp/flarum-websocket-notification/./node_modules/dayjs/dayjs.min.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/regenerator/index.js","webpack://@xypp/flarum-websocket-notification/webpack/bootstrap","webpack://@xypp/flarum-websocket-notification/webpack/runtime/compat get default export","webpack://@xypp/flarum-websocket-notification/webpack/runtime/define property getters","webpack://@xypp/flarum-websocket-notification/webpack/runtime/hasOwnProperty shorthand","webpack://@xypp/flarum-websocket-notification/webpack/runtime/make namespace object","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/extenders']\"","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/Model']\"","webpack://@xypp/flarum-websocket-notification/./src/common/model/WebsocketAccessToken.ts","webpack://@xypp/flarum-websocket-notification/./src/common/extend.ts","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/app']\"","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@xypp/flarum-websocket-notification/./src/common/Data/ModelPath.ts","webpack://@xypp/flarum-websocket-notification/./src/common/helper/WebsocketHelper.ts","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/extend']\"","webpack://@xypp/flarum-websocket-notification/./src/common/util/frontend.ts","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/Component']\"","webpack://@xypp/flarum-websocket-notification/./src/common/util/NodeUtil.ts","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Button']\"","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/NotificationFloater.tsx","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Select']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Link']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/WrappedFlagNotification.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/utils/unreadTip.ts","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/ComingDiscussion.tsx","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/ComposerBody']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/PostStream']\"","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/TypingTip.tsx","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/models/User']\"","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/index.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/notification.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/post.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/discussionList.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/like.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/typing.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/reaction.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/online.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/poll.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/components/ConnectionIndicator.tsx","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/HeaderSecondary']\"","webpack://@xypp/flarum-websocket-notification/./src/forum/index.ts"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",c=\"month\",f=\"quarter\",h=\"year\",d=\"date\",l=\"Invalid Date\",$=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\"),ordinal:function(t){var e=[\"th\",\"st\",\"nd\",\"rd\"],n=t%100;return\"[\"+t+(e[(n-20)%10]||e[n]||e[0])+\"]\"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,c),s=n-i<0,u=e.clone().add(r+(s?-1:1),c);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:h,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:f}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},g=\"en\",D={};D[g]=M;var p=\"$isDayjsObject\",S=function(t){return t instanceof _||!(!t||!t[p])},w=function t(e,n,r){var i;if(!e)return g;if(\"string\"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split(\"-\");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},O=function(t,e){if(S(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},b=v;b.l=w,b.i=S,b.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[p]=!0}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return b},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=O(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return O(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<O(t)},m.$g=function(t,e,n){return b.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!b.u(e)||e,f=b.p(t),l=function(t,e){var i=b.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return b.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v=\"set\"+(this.$u?\"UTC\":\"\");switch(f){case h:return r?l(1,0):l(31,11);case c:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+\"Hours\",0);case u:return $(v+\"Minutes\",1);case s:return $(v+\"Seconds\",2);case i:return $(v+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=b.p(t),f=\"set\"+(this.$u?\"UTC\":\"\"),l=(n={},n[a]=f+\"Date\",n[d]=f+\"Date\",n[c]=f+\"Month\",n[h]=f+\"FullYear\",n[u]=f+\"Hours\",n[s]=f+\"Minutes\",n[i]=f+\"Seconds\",n[r]=f+\"Milliseconds\",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===c||o===h){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[b.p(t)]()},m.add=function(r,f){var d,l=this;r=Number(r);var $=b.p(f),y=function(t){var e=O(l);return b.w(e.date(e.date()+Math.round(t*r)),l)};if($===c)return this.set(c,this.$M+r);if($===h)return this.set(h,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return b.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=b.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,c=n.months,f=n.meridiem,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},d=function(t){return b.s(s%12||12,t,\"0\")},$=f||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r};return r.replace(y,(function(t,r){return r||function(t){switch(t){case\"YY\":return String(e.$y).slice(-2);case\"YYYY\":return b.s(e.$y,4,\"0\");case\"M\":return a+1;case\"MM\":return b.s(a+1,2,\"0\");case\"MMM\":return h(n.monthsShort,a,c,3);case\"MMMM\":return h(c,a);case\"D\":return e.$D;case\"DD\":return b.s(e.$D,2,\"0\");case\"d\":return String(e.$W);case\"dd\":return h(n.weekdaysMin,e.$W,o,2);case\"ddd\":return h(n.weekdaysShort,e.$W,o,3);case\"dddd\":return o[e.$W];case\"H\":return String(s);case\"HH\":return b.s(s,2,\"0\");case\"h\":return d(1);case\"hh\":return d(2);case\"a\":return $(s,u,!0);case\"A\":return $(s,u,!1);case\"m\":return String(u);case\"mm\":return b.s(u,2,\"0\");case\"s\":return String(e.$s);case\"ss\":return b.s(e.$s,2,\"0\");case\"SSS\":return b.s(e.$ms,3,\"0\");case\"Z\":return i}return null}(t)||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=this,M=b.p(d),m=O(r),v=(m.utcOffset()-this.utcOffset())*e,g=this-m,D=function(){return b.m(y,m)};switch(M){case h:$=D()/12;break;case c:$=D();break;case f:$=D()/3;break;case o:$=(g-v)/6048e5;break;case a:$=(g-v)/864e5;break;case u:$=g/n;break;case s:$=g/e;break;case i:$=g/t;break;default:$=g}return l?$:b.a($)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return b.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),k=_.prototype;return O.prototype=k,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",c],[\"$y\",h],[\"$D\",d]].forEach((function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,_,O),t.$i=!0),O},O.locale=w,O.isDayjs=S,O.unix=function(t){return O(1e3*t)},O.en=D[g],O.Ls=D,O.p={},O}));","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class WebsocketAccessToken extends Model {\n  token = Model.attribute<string>('token');\n  url = Model.attribute<string>('url', (url?: any) => url && url.replace(\"0.0.0.0\", location.hostname));\n}","import Extend from 'flarum/common/extenders';\r\nimport WebsocketAccessToken from './model/WebsocketAccessToken';\r\nexport default [\r\n    new Extend.Store()\r\n        .add('websocket-access-token', WebsocketAccessToken)\r\n];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","type ModelPathNode = {\r\n    id?: string;\r\n    name: string;\r\n}\r\nexport class ModelPath {\r\n    nodes: ModelPathNode[];\r\n    data: any;\r\n    constructor(str?: string) {\r\n        if (str) {\r\n            if (str.endsWith(\"}\")) {\r\n                const t = str.split('||');\r\n                this.data = JSON.parse(t[1]);\r\n                str = t[0];\r\n            }\r\n            this.nodes = str.split('.').map(n => {\r\n                const ret: ModelPathNode = { name: n };\r\n                if (n.includes('[')) {\r\n                    const [name, id] = n.split('[');\r\n                    ret.id = id.substring(0, id.length - 1);\r\n                    ret.name = name;\r\n                }\r\n                return ret;\r\n            });\r\n        } else {\r\n            this.nodes = [];\r\n        }\r\n    }\r\n    toString(): string {\r\n        return this.nodes.map(n => n.id ? `${n.name}[${n.id}]` : n.name).join('.') + (this.data ? `||${JSON.stringify(this.data)}` : \"\");\r\n    }\r\n    add(name: string, id?: string): this {\r\n        this.nodes.push({ name, id });\r\n        return this;\r\n    }\r\n    get(name?: string): ModelPathNode | null {\r\n        if (!name) return this.nodes[this.nodes.length - 1] || null;\r\n        return this.nodes.find(n => n.name === name) || null;\r\n    }\r\n    getId(name?: string): string | null {\r\n        const node = this.get(name);\r\n        return node && (node.id || null);\r\n    }\r\n    remove(name: string): this {\r\n        const index = this.nodes.findIndex(n => n.name === name);\r\n        if (index >= 0) {\r\n            this.nodes.splice(index, 1);\r\n        }\r\n        return this;\r\n    }\r\n    getData(): any {\r\n        return this.data;\r\n    }\r\n    setData(data: any): this {\r\n        this.data = data;\r\n        return this;\r\n    }\r\n\r\n}","import AdminApplication from \"flarum/admin/AdminApplication\";\r\nimport ItemList from \"flarum/common/utils/ItemList\";\r\nimport ForumApplication from \"flarum/forum/ForumApplication\";\r\nimport { ModelPath } from \"../Data/ModelPath\";\r\nimport WebsocketAccessToken from \"../model/WebsocketAccessToken\";\r\nimport dayjs from \"dayjs\";\r\nexport type STATUS = \"online\" | \"offline\" | \"connecting\" | \"partial\";\r\n\r\nconst RETRY_INTERVALS = [100, 2000, 5000, 10000, 60000, 120000];\r\n\r\nexport class WebsocketHelper {\r\n    app?: ForumApplication | AdminApplication;\r\n    ws?: WebSocket\r\n    statusChangeCb?: (status: STATUS) => void;\r\n    lastConnected: number = 0;\r\n    firstSubscribe: boolean = true;\r\n    context: Record<string, any> = {};\r\n    lastSubscribes: string[] = [];\r\n    pingInterval?: any;\r\n    nextRetry = 0;\r\n    inRetryStatus = false;\r\n    sendInConnecting: { [key: string]: any; type: string; }[] = [];\r\n    static instance?: WebsocketHelper;\r\n    public static getInstance(): WebsocketHelper {\r\n        if (!WebsocketHelper.instance) {\r\n            WebsocketHelper.instance = new WebsocketHelper();\r\n        }\r\n        return WebsocketHelper.instance;\r\n    }\r\n    init(app: ForumApplication | AdminApplication) {\r\n        this.app = app;\r\n        this.lastConnected = dayjs().unix() - 5;\r\n    }\r\n    async start() {\r\n        if (this.app) {\r\n            this.sendInConnecting = [];\r\n            if (this.ws) {\r\n                try {\r\n                    this.ws.onclose = () => { }\r\n                    this.ws.close();\r\n                } finally {\r\n                    this.ws = undefined;\r\n                };\r\n            }\r\n            if (this.statusChangeCb) this.statusChangeCb(\"connecting\");\r\n            let item: WebsocketAccessToken | null = null;\r\n            try {\r\n                item = await this.app.store.createRecord<WebsocketAccessToken>(\"websocket-access-token\").save({});\r\n            } catch (e) {\r\n                this.retry();\r\n            }\r\n            if (!item) {\r\n                this.retry();\r\n                return;\r\n            }\r\n            const ws = new WebSocket(item.url());\r\n            this.ws = ws;\r\n            ws.onclose = () => {\r\n                this.retry();\r\n                if (this.pingInterval)\r\n                    clearInterval(this.pingInterval);\r\n            }\r\n            ws.onerror = () => {\r\n                this.retry();\r\n                if (this.pingInterval)\r\n                    clearInterval(this.pingInterval);\r\n            }\r\n            ws.onopen = () => {\r\n                this.firstSubscribe = true;\r\n                this.lastSubscribes = [];\r\n                this.reSubscribe();\r\n                this.pingInterval = setInterval(this.ping.bind(this), 30000);\r\n                this.sendInConnecting.forEach(v => this.send(v));\r\n                this.sendInConnecting = [];\r\n                if (this.statusChangeCb) this.statusChangeCb(\"online\");\r\n                this.nextRetry = 0;\r\n                this.lastConnected = dayjs().unix();\r\n            }\r\n            ws.onmessage = (e) => {\r\n                this.lastConnected = dayjs().unix();\r\n                const data = JSON.parse(e.data);\r\n                if (data.type === \"sync\")\r\n                    this.messageHandler(new ModelPath(data.path), data.data);\r\n            }\r\n        }\r\n    }\r\n    messageHandler(path: ModelPath, data: any) {\r\n        // To be implemented in extends\r\n        console.log(`No handler found ${path.toString()}: ${JSON.stringify(data)}`);\r\n    }\r\n    getSubscribes(context: Record<string, any>): ItemList<ModelPath> {\r\n        return new ItemList<ModelPath>();\r\n    }\r\n    setContext(context: Record<string, any>) {\r\n        Object.keys(context).forEach(v => {\r\n            if (context[v] === null && this.context[v]) delete this.context[v];\r\n            else this.context[v] = context[v];\r\n        });\r\n        return this;\r\n    }\r\n    reSubscribe(tempContext?: Record<string, any>) {\r\n        const newSub = this.getSubscribes(Object.assign(tempContext || {}, this.context)).toArray().map(v => v.toString());\r\n        console.log(`ReSubscribe: ${newSub.join(\", \")}`);\r\n        if (!this.changed(newSub)) return;\r\n        this.lastSubscribes = newSub;\r\n        let data: any = {\r\n            type: \"subscribe\",\r\n            path: newSub\r\n        };\r\n        if (this.firstSubscribe) {\r\n            this.firstSubscribe = false;\r\n            data.restore = dayjs().unix() - this.lastConnected;\r\n        }\r\n        this.send(data);\r\n        return this;\r\n    }\r\n    state(path: ModelPath) {\r\n        if (!this.app?.session.user) return;\r\n        this.send({\r\n            type: \"state\",\r\n            path: path.toString()\r\n        })\r\n    }\r\n    send(data: { type: string, [key: string]: any }) {\r\n        if (this.ws) {\r\n            if (this.ws.readyState === WebSocket.CONNECTING) {\r\n                this.sendInConnecting.push(data);\r\n            } else if (this.ws.readyState === WebSocket.OPEN) {\r\n                try {\r\n                    this.ws.send(JSON.stringify(data));\r\n                } catch (e) {\r\n                    console.log(`Error Websocket Sending ${e}`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    onStatusChange(cb: (status: STATUS) => void) {\r\n        this.statusChangeCb = cb;\r\n    }\r\n    retry() {\r\n        if (this.inRetryStatus) return;\r\n        this.inRetryStatus = true;\r\n        if (this.statusChangeCb) this.statusChangeCb(\"offline\");\r\n        setTimeout(() => {\r\n            this.inRetryStatus = false;\r\n            this.start();\r\n        }, RETRY_INTERVALS[this.nextRetry - 1]);\r\n        if (this.nextRetry < RETRY_INTERVALS.length) {\r\n            this.nextRetry += 1;\r\n        }\r\n    }\r\n    protected ping() {\r\n        this.send({\r\n            type: \"ping\"\r\n        });\r\n    }\r\n    protected changed(newSub: string[]): boolean {\r\n        newSub.sort((a, b) => a.localeCompare(b));\r\n        if (newSub.length !== this.lastSubscribes.length) return true;\r\n        for (let i = 0; i < newSub.length; i++) {\r\n            if (newSub[i] !== this.lastSubscribes[i]) return true;\r\n        }\r\n        return false;\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../Data/ModelPath\";\r\nimport { extend, override } from \"flarum/common/extend\"\r\nimport { WebsocketHelper } from \"../helper/WebsocketHelper\";\r\nexport function addSubscribeCb(name: string, cb: (items: ItemList<ModelPath>, context: Record<string, any>) => void) {\r\n    extend(WebsocketHelper.prototype, \"getSubscribes\", cb);\r\n}\r\nexport function addMessageCb(name: string, cb: (path: ModelPath, data: any) => void) {\r\n    override(WebsocketHelper.prototype, \"messageHandler\", function (orig: (path: ModelPath, data: any) => void, path: ModelPath, data: any) {\r\n        if (path.get()?.name == name) {\r\n            return cb(path, data);\r\n        }\r\n        orig(path, data);\r\n    });\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","export function showIf(judgement: boolean, vnode: any, def?: any) {\n    return judgement ? vnode : (def || \"\");\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import Component from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport { showIf } from \"../../../common/util/NodeUtil\";\r\nimport Button from \"flarum/common/components/Button\"\r\n\r\nexport default class NotificationFloater extends Component<{\r\n    notifications: { time: number, first: boolean, notification: any }[],\r\n    dismiss: () => void\r\n}> {\r\n    view(vnode: any) {\r\n        const position = (app.session?.user?.preferences() || {})[\"xyppWsnFloaterPosition\"] || \"center\";\r\n        return <div className={showIf(this.attrs.notifications.length > 0, \"notification-floater\", \"notification-floater hidden\") + \" \" + position}>\r\n            {this.attrs.notifications.map(n => {\r\n                const type = n.notification.data.attributes.contentType;\r\n                const cls = app.notificationComponents[type];\r\n                return <div className={showIf(n.first, \"notification-floater-item in\", \"notification-floater-item\")}>\r\n                    {showIf(!!cls, m(cls, { notification: n.notification }), <div>{type}</div>)}\r\n                </div>\r\n            })}\r\n            <div className=\"notification-floater-close-container\">\r\n                <Button className=\"Button Button-primary\" onclick={this.attrs.dismiss}>\r\n                    <i className=\"fas fa-times\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.close_notification_floater\")}\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/FieldSet'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","import Component from \"flarum/common/Component\";\r\nimport Link from \"flarum/common/components/Link\";\r\nimport app from \"flarum/forum/app\";\r\nimport avatar from \"flarum/common/helpers/avatar\";\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport username from \"flarum/common/helpers/username\";\r\nimport humanTime from \"flarum/common/helpers/humanTime\";\r\nexport default class WrappedFlagNotification extends Component<{\r\n    notification: any\r\n}> {\r\n    view() {\r\n        const flag = this.attrs.notification.data.attributes.flag;\r\n        const post = flag.post();\r\n        return <Link\r\n            href={app.route.post(post)}\r\n            className=\"Notification Flag\"\r\n            onclick={(e: any) => {\r\n                (app.flags as any).index = post;\r\n                e.redraw = false;\r\n            }}\r\n        >\r\n            {avatar(post.user())}\r\n            {icon('fas fa-flag', { className: 'Notification-icon' })}\r\n            <span className=\"Notification-content\">\r\n                {app.translator.trans('flarum-flags.forum.flagged_posts.item_text', {\r\n                    username: username(post.user()),\r\n                    em: <em />,\r\n                    discussion: post.discussion().title(),\r\n                })}\r\n            </span>\r\n            {humanTime(flag.createdAt())}\r\n            <div className=\"Notification-excerpt\">{post.contentPlain()}</div>\r\n        </Link>\r\n    }\r\n}","import app from \"flarum/forum/app\";\r\n\r\nlet unreadCount = 0;\r\n\r\nexport function initUnreadTip() {\r\n    window.addEventListener('focus', () => {\r\n        unreadCount = 0;\r\n        app.setTitleCount(0);\r\n    });\r\n}\r\nexport function addUnread() {\r\n    if (!document.hasFocus()) {\r\n        unreadCount++;\r\n        console.log(`Update unread:${unreadCount}`);\r\n        app.setTitleCount(unreadCount);\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","import Component from \"flarum/common/Component\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport app from \"flarum/forum/app\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport Link from \"flarum/common/components/Link\"\r\nimport { showIf } from \"../../../common/util/NodeUtil\";\r\nexport default class ComingDiscussion extends Component<{\r\n    list: {\r\n        title: string,\r\n        id: string,\r\n        count: number,\r\n        post: number\r\n    }[],\r\n    cb: () => void\r\n}> {\r\n    autoRefreshTimeout: any = null;\r\n    autoRefresh: boolean = false;\r\n    countdown: number = 30;\r\n    oncreate(vnode: any): void {\r\n        super.oncreate(vnode);\r\n        this.autoRefresh = app.session?.user?.preferences()?.xyppWsnNewDiscussionAutoRefresh || false;\r\n        if (this.autoRefresh) {\r\n            this.autoRefreshTimeout = setInterval(() => {\r\n                this.updateCtd();\r\n            }, 1000);\r\n        }\r\n    }\r\n    onbeforeremove(vnode: any): void {\r\n        super.onbeforeremove(vnode);\r\n        if (this.autoRefreshTimeout) {\r\n            clearInterval(this.autoRefreshTimeout);\r\n        }\r\n    }\r\n    view(vnode: any) {\r\n        return <div className=\"ComingDiscussion\">\r\n            <div className=\"ComingDiscussion-icon\">\r\n                <i className=\"fas fa-star-of-life\"></i>\r\n                <div className=\"ComingDiscussion-icon-text\">\r\n                    {app.translator.trans('xypp-websocket-notification.forum.new_discussion.tip')}\r\n                </div>\r\n            </div>\r\n            <div className=\"ComingDiscussion-item-container\">\r\n                {\r\n                    this.attrs.list.map(item => {\r\n                        return <div class=\"ComingDiscussion-item\">\r\n                            <span className=\"ComingDiscussion-count\">{item.count}</span>\r\n                            <Link className=\"ComingDiscussion-link\" href={app.route(\"discussion.near\", {\r\n                                id: item.id,\r\n                                near: item.post\r\n                            })}>{item.title}</Link>\r\n                        </div>\r\n                    })\r\n                }\r\n            </div>\r\n            <div className=\"ComingDiscussion-Reload\">\r\n                <Button class=\"Button\" onclick={this.callback.bind(this)}><i className=\"fas fa-sync\"></i></Button>\r\n                {showIf(this.autoRefresh, <div className=\"autoReloadIndicator\">{this.countdown}</div>)}\r\n            </div>\r\n        </div>\r\n    }\r\n    callback() {\r\n        if (this.autoRefreshTimeout) {\r\n            clearInterval(this.autoRefreshTimeout);\r\n            this.autoRefreshTimeout = null;\r\n            this.autoRefresh = false;\r\n        }\r\n        this.attrs.cb();\r\n    }\r\n    updateCtd() {\r\n        if (this.countdown > 0) {\r\n            this.countdown--;\r\n            if (this.countdown == 0) {\r\n                this.callback();\r\n            }\r\n            m.redraw();\r\n        }\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ComposerBody'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostStream'];","import Component from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport { showIf } from \"../../../common/util/NodeUtil\";\r\nimport Button from \"flarum/common/components/Button\"\r\nimport User from \"flarum/common/models/User\";\r\nimport avatar from \"flarum/common/helpers/avatar\"\r\nimport username from \"flarum/common/helpers/username\"\r\nimport Link from \"flarum/common/components/Link\";\r\nexport default class TypingTip extends Component<{\r\n    typingUsers: User[]\r\n}> {\r\n    view(vnode: any) {\r\n        let MAX_LIST_LEN = parseInt(app.forum.attribute(\"xyppWsnTypeTipCountLimit\") || \"4\");\r\n        if (!this.attrs.typingUsers.length) {\r\n            return <div>{app.translator.trans(\"xypp-websocket-notification.forum.typing.no_one\")}</div>\r\n        }\r\n        return <div className=\"PostStream-item\">\r\n            <div className=\"LineContainer\">\r\n                <div className=\"users\">\r\n                    {this.attrs.typingUsers.slice(0, MAX_LIST_LEN).map(u => <Link className=\"typingUser\" href={app.route.user(u)}>\r\n                        {avatar(u)}\r\n                        <span className=\"username\">{username(u)}</span>\r\n                    </Link>)}\r\n                </div>\r\n                {showIf(this.attrs.typingUsers.length > MAX_LIST_LEN, <div>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.typing.and_more\", { rest: this.attrs.typingUsers.length - MAX_LIST_LEN })}\r\n                </div>)}\r\n                <div>{app.translator.trans(\"xypp-websocket-notification.forum.typing.is_typing\")}</div>\r\n            </div>\r\n        </div>\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","import app from \"flarum/forum/app\";\r\nimport { initNotification } from \"./notification\";\r\nimport { initPost } from \"./post\";\r\nimport { initDiscussionList } from \"./discussionList\";\r\nimport { initLike } from \"./like\";\r\nimport { initTypingTip } from \"./typing\";\r\nimport { initReaction } from \"./reaction\";\r\nimport { initOnline } from \"./online\";\r\nimport { initPoll } from \"./poll\";\r\n\r\nexport default function init() {\r\n    initNotification();\r\n    initPost();\r\n    initDiscussionList();\r\n    initLike();\r\n    initTypingTip();\r\n    initReaction();\r\n    initOnline();\r\n    initPoll();\r\n}","import app from \"flarum/forum/app\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport NotificationFloater from \"./components/NotificationFloater\";\r\nimport { extend } from \"flarum/common/extend\";\r\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\r\nimport FieldSet from \"flarum/common/components/FieldSet\"\r\nimport Select from \"flarum/common/components/Select\";\r\nimport WrappedFlagNotification from \"./components/WrappedFlagNotification\";\r\nimport { addUnread } from \"../utils/unreadTip\";\r\nexport function initNotification() {\r\n  let notifications: { time: number, first: boolean, notification: any }[] = [];\r\n  addSubscribeCb('notification', (items) => {\r\n    if (app.session?.user)\r\n      items.add(\"notification\", new ModelPath().add(\"notification\", app.session.user.id()));\r\n    if (app.session?.user?.isAdmin()) {\r\n      items.add(\"flag\", new ModelPath().add(\"flag\"));\r\n    }\r\n  });\r\n  addMessageCb('notification', (path, data) => {\r\n    const model = app.store.pushPayload(data);\r\n    const obj = { time: 8, first: false, notification: model };\r\n    notifications.unshift(obj);\r\n    addUnread();\r\n    if (app.session.user)\r\n      app.session.user.pushAttributes({\r\n        unreadNotificationCount: (app.session.user.unreadNotificationCount() ?? 0) + 1,\r\n        newNotificationCount: (app.session.user.newNotificationCount() ?? 0) + 1,\r\n      });\r\n    m.redraw();\r\n    setTimeout(() => {\r\n      obj.first = true;\r\n      m.redraw();\r\n    }, 100);\r\n  });\r\n  addMessageCb('flag', (path, data) => {\r\n    const model = app.store.pushPayload(data);\r\n    const notification = {\r\n      data: { attributes: { contentType: \"wrappedFlag\", flag: model } }\r\n    }\r\n    const obj = { time: 8, first: false, notification };\r\n    notifications.unshift(obj);\r\n    if (app.flags?.cache && Array.isArray(app.flags.cache)) {\r\n      app.flags.cache.unshift(model);\r\n    }\r\n    (app.forum.data.attributes as any).flagCount++;\r\n    m.redraw();\r\n    setTimeout(() => {\r\n      obj.first = true;\r\n      m.redraw();\r\n    }, 100);\r\n  });\r\n  function dismiss() {\r\n    while (notifications.length) {\r\n      notifications.pop();\r\n    }\r\n  }\r\n\r\n  const ctr = $(\"<div></div>\").addClass(\"notification-floater-container\")\r\n  ctr.appendTo(document.body);\r\n  m.mount(ctr[0], { view: function () { return NotificationFloater.component({ notifications, dismiss }) } });\r\n\r\n  setInterval(() => {\r\n    notifications.forEach(element => {\r\n      element.time--;\r\n    });\r\n    let changed = false;\r\n    for (let i = notifications.length - 1; i >= 0; i--) {\r\n      if (notifications[i].time <= 0) {\r\n        notifications.splice(i, 1);\r\n        changed = true;\r\n      }\r\n    }\r\n    if (changed)\r\n      m.redraw();\r\n  }, 1000);\r\n\r\n  const SELECT_FLOATER = {\r\n    \"left\": app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.left\"),\r\n    \"right\": app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.right\"),\r\n    \"center\": app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.center\")\r\n  }\r\n  extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n    const position = (app.session?.user?.preferences() || {})[\"xyppWsnFloaterPosition\"] || \"center\";\r\n    items.add(\r\n      'xypp-wsn-floater-position',\r\n      <FieldSet label={app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.title\")} className=\"Settings-floater\">\r\n        <p>{app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.desc\")}</p>\r\n        <Select\r\n          options={SELECT_FLOATER}\r\n          value={position}\r\n          onchange={(value: string) => {\r\n            app.session.user!\r\n              .savePreferences({\r\n                \"xyppWsnFloaterPosition\": value\r\n              });\r\n          }}\r\n        />\r\n      </FieldSet>\r\n    );\r\n  })\r\n\r\n  app.notificationComponents.wrappedFlag = WrappedFlagNotification as any;\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport PostStreamState from \"flarum/forum/states/PostStreamState\"\r\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\"\r\nimport { extend } from \"flarum/common/extend\";\r\nimport { WebsocketHelper } from \"../../common/helper/WebsocketHelper\";\r\nimport PageState from \"flarum/common/states/PageState\";\r\nimport { addUnread } from \"../utils/unreadTip\";\r\nexport function initPost() {\r\n    addSubscribeCb(\"post\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussion) {\r\n            items.add(\"discussion\", new ModelPath().add(\"discussion\", context.discussion).add(\"post\"));\r\n        }\r\n    })\r\n    addMessageCb(\"post\", (path: ModelPath, data: any) => {\r\n        const route = ((app.current.data as any) ?? {}).routeName;\r\n        if (route !== \"discussion\" && route !== \"discussion.near\") return;\r\n        const discussion: Discussion = (app.current.data as any).discussion;\r\n        const stream: PostStreamState = app.current.get(\"stream\");\r\n        if (discussion.id() == path.getId(\"discussion\") && stream.viewingEnd()) {\r\n            const model = app.store.pushPayload<Post>(data);\r\n            if (!((discussion.data as any).relationships.posts.data.find((v: any) => v.id == model.id()))) {\r\n                (discussion.data as any).relationships.posts.data.push({ type: 'posts', id: model.id() });\r\n                stream.loadNext();\r\n                addUnread();\r\n            } else {\r\n                m.redraw();\r\n            }\r\n        }\r\n    });\r\n    let removeStack = 0;\r\n    extend(DiscussionPage.prototype, \"show\", function (this: DiscussionPage, r: any, discussion: Discussion) {\r\n        if (discussion) {\r\n            removeStack++;\r\n            WebsocketHelper.getInstance().setContext({\r\n                discussion: discussion!.id()\r\n            }).reSubscribe();\r\n        }\r\n    })\r\n    extend(DiscussionPage.prototype, \"onbeforeremove\", function (this: DiscussionPage) {\r\n        if (this.discussion) {\r\n            removeStack--;\r\n            if (removeStack < 0) removeStack = 0;\r\n            if (removeStack == 0)\r\n                WebsocketHelper.getInstance().setContext({\r\n                    discussion: null\r\n                }).reSubscribe();\r\n        }\r\n    })\r\n}\r\n","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport app from \"flarum/forum/app\";\r\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\"\r\nimport { extend } from \"flarum/common/extend\";\r\nimport { WebsocketHelper } from \"../../common/helper/WebsocketHelper\";\r\nimport DiscussionList from \"flarum/forum/components/DiscussionList\"\r\nimport ComingDiscussion from \"./components/ComingDiscussion\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport FieldSet from \"flarum/common/components/FieldSet\";\r\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\r\nimport Switch from \"flarum/common/components/Switch\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport { addUnread } from \"../utils/unreadTip\";\r\nexport function initDiscussionList() {\r\n    addSubscribeCb(\"discussion\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussionList) {\r\n            if (context.discussionListTag) {\r\n                const tag = app.store.getBy<any>(\"tags\", \"slug\", context.discussionListTag);\r\n                if (tag) {\r\n                    items.add(\"discussionList\", new ModelPath().add(\"tag\", tag.id()).add(\"discussion\"));\r\n                }\r\n            } else {\r\n                items.add(\"discussionList\", new ModelPath().add(\"discussion\"));\r\n            }\r\n        }\r\n    })\r\n    let comingDiscussions: {\r\n        title: string;\r\n        post: number;\r\n        id: string;\r\n        count: number;\r\n    }[] = [];\r\n    let toPullUpDiscussions: Discussion[] = [];\r\n    function refresh() {\r\n        toPullUpDiscussions.forEach(app.discussions.addDiscussion.bind(app.discussions));\r\n\r\n        comingDiscussions = [];\r\n        toPullUpDiscussions = [];\r\n        m.redraw();\r\n    }\r\n    function addOne(id: string, title: string, post: number) {\r\n        if ((app.current?.data as any)?.discussion?.id() == id) return;\r\n        let baseCount = 0;\r\n        let exist = false;\r\n        for (let i = 0; i < comingDiscussions.length; i++) {\r\n            if (comingDiscussions[i].id == id) {\r\n                baseCount = comingDiscussions[i].count;\r\n                comingDiscussions.splice(i, 1);\r\n                exist = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!exist) {\r\n            const routeName: string = (app.current?.data as any)?.routeName || \"\";\r\n            if (routeName !== \"discussion\" && routeName !== \"discussion.near\")\r\n                addUnread();\r\n        }\r\n        comingDiscussions.unshift({\r\n            title: title,\r\n            post: post,\r\n            id: id,\r\n            count: baseCount + 1\r\n        });\r\n        const maxLen = (app.session?.user?.preferences() || {})[\"xyppWsnNewDiscussionListLen\"] || 5;\r\n        if (comingDiscussions.length > maxLen) {\r\n            comingDiscussions.pop();\r\n        }\r\n    }\r\n\r\n    addMessageCb(\"discussion\", (path: ModelPath, data: any) => {\r\n        const discussion: Discussion = app.store.pushPayload<Discussion>(data.discussion);\r\n        const idx = toPullUpDiscussions.findIndex(d => d.id() == discussion.id());\r\n        if (idx != -1) {\r\n            toPullUpDiscussions.splice(idx, 1);\r\n        }\r\n        toPullUpDiscussions.push(discussion);\r\n        addOne(discussion.id() as string, discussion.title(), data.post);\r\n        m.redraw();\r\n    });\r\n\r\n\r\n\r\n    extend(DiscussionList.prototype, \"view\", function (this: DiscussionList, vnode: any) {\r\n        if (comingDiscussions.length && vnode && vnode.children && Array.isArray(vnode.children)) {\r\n            vnode.children.unshift(ComingDiscussion.component({\r\n                list: comingDiscussions,\r\n                cb: (() => {\r\n                    refresh();\r\n                }).bind(this)\r\n            }));\r\n        }\r\n    })\r\n    extend(DiscussionList.prototype, \"oncreate\", function (this: DiscussionList) {\r\n        const tag = (this.attrs as any).state.params.tags;\r\n        WebsocketHelper.getInstance().setContext({\r\n            discussionListTag: tag,\r\n            discussionList: true\r\n        }).reSubscribe();\r\n    });\r\n    extend(DiscussionList.prototype, \"onbeforeremove\", () => {\r\n        WebsocketHelper.getInstance().setContext({\r\n            discussionList: null\r\n        }).reSubscribe();\r\n    });\r\n\r\n\r\n    extend(DiscussionPage.prototype, \"show\", function (this: DiscussionPage, r: any, discussion: Discussion) {\r\n        if (discussion)\r\n            for (let i = comingDiscussions.length - 1; i >= 0; i--) {\r\n                if (comingDiscussions[i].id == discussion.id()) {\r\n                    comingDiscussions.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n    })\r\n\r\n\r\n    let savingList = false;\r\n    extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n        items.add(\r\n            'xypp-wsn-newPostOption',\r\n            <FieldSet label={app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.title\")} className=\"Settings-newPost\">\r\n                <p><Switch\r\n                    state={((app.session?.user?.preferences() || {})[\"xyppWsnNewDiscussionAutoRefresh\"] || false)}\r\n                    onchange={(v: boolean) => {\r\n                        app.session?.user?.savePreferences({\r\n                            \"xyppWsnNewDiscussionAutoRefresh\": v\r\n                        });\r\n                    }}\r\n                >{app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.auto_refresh\")}</Switch></p>\r\n                <p>{app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.list_length\")}</p>\r\n                <div>\r\n                    <input\r\n                        id=\"input-xyppWsnNewDiscussionListLen\"\r\n                        className=\"FormControl\"\r\n                        type=\"number\"\r\n                        value={((app.session?.user?.preferences() || {})[\"xyppWsnNewDiscussionListLen\"] || 5)}\r\n                    />\r\n                    <Button className=\"Button Button--primary\" onclick={((e: any) => {\r\n                        e.preventDefault();\r\n                        savingList = true;\r\n                        m.redraw();\r\n                        app.session?.user?.savePreferences({\r\n                            \"xyppWsnNewDiscussionListLen\": parseInt($(\"#input-xyppWsnNewDiscussionListLen\").val() as string)\r\n                        }).then(() => {\r\n                            savingList = false;\r\n                            m.redraw();\r\n                        });\r\n                    })} disabled={savingList} loading={savingList}>{app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.list_len_button\")}</Button>\r\n                </div>\r\n            </FieldSet>\r\n        );\r\n    })\r\n}","import app from \"flarum/forum/app\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\n\r\nexport function initLike() {\r\n    addSubscribeCb(\"like\", (items, context) => {\r\n        if (context.discussion) {\r\n            items.add(\"like\", new ModelPath().add(\"discussion\", context.discussion).add(\"post\").add(\"like\"));\r\n        }\r\n    });\r\n    addMessageCb(\"like\", (path, data) => {\r\n        const post = app.store.getById(\"posts\", data.post);\r\n        if (!app.store.getById(\"users\", data.user.data.id)) {\r\n            app.store.pushPayload(data.user);\r\n        }\r\n        if (post) {\r\n            const like: { data: { type: string, id: string }[] } = (post.data.relationships as any).likes;\r\n            for (let i = 0; i < like.data.length; i++) {\r\n                if (like.data[i].id == data.user.data.id) {\r\n                    if (!data.like) {\r\n                        like.data.splice(i, 1);\r\n                        post.freshness=new Date();\r\n                        m.redraw();\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n            if (data.like) {\r\n                like.data.push({\r\n                    type: \"users\",\r\n                    id: data.user.data.id\r\n                });\r\n                post.freshness=new Date();\r\n                m.redraw();\r\n            }\r\n        }\r\n    })\r\n}","import { extend } from \"flarum/common/extend\";\r\nimport ComposerBody from \"flarum/forum/components/ComposerBody\";\r\nimport { WebsocketHelper } from \"../../common\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport app from \"flarum/forum/app\";\r\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport User from \"flarum/common/models/User\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport ItemList from \"flarum/common/utils/ItemList\";\r\nimport PostStream from \"flarum/forum/components/PostStream\";\r\nimport TypingTip from \"./components/TypingTip\";\r\nimport FieldSet from \"flarum/common/components/FieldSet\";\r\nimport Switch from \"flarum/common/components/Switch\";\r\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\r\nexport function initTypingTip() {\r\n    addMessageCb(\"typing\", (path: ModelPath, data: any) => {\r\n        const discussion = app.store.getById(\"discussions\", path.getId(\"discussion\") as string);\r\n        if (discussion) {\r\n            const typings = (discussion as any).typingUsers;\r\n            for (let i = 0; i < typings.length; i++) {\r\n                if (typings[i].id() == path.getId(\"state\")) {\r\n                    typings.splice(i, 1);\r\n                    if (!data.state) {\r\n                        m.redraw();\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            if (!data.state) {\r\n                (discussion as any).restTypingUsers--;\r\n                return;\r\n            }\r\n            typings.unshift(app.store.pushPayload<User>(data.user));\r\n            m.redraw();\r\n        }\r\n    });\r\n    addSubscribeCb(\"typing\", (items, context) => {\r\n        if (!app.forum.attribute(\"xyppWsnTypeTip\")) {\r\n            return;\r\n        }\r\n        if (context.discussion) {\r\n            items.add(\"typing\", new ModelPath().add(\"state\").add(\"session\").add(\"discussion\", context.discussion).add(\"typing\"));\r\n        }\r\n    });\r\n    extend(ComposerBody.prototype, \"oninit\", function (this: ComposerBody, val: any) {\r\n        if (!app.forum.attribute(\"xyppWsnTypeTip\")) {\r\n            return;\r\n        }\r\n        if ((app.session?.user?.preferences() || {})[\"xyppWsnNoTypeTip\"]) {\r\n            return;\r\n        }\r\n        if ((this.attrs as any).discussion)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"session\")\r\n                    .add(\"discussion\", (this.attrs as any).discussion.id())\r\n                    .add(\"typing\")\r\n                );\r\n        if ((this.attrs as any).post)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"session\")\r\n                    .add(\"discussion\", (this.attrs as any).post.discussion().id())\r\n                    .add(\"typing\")\r\n                );\r\n    });\r\n    extend(ComposerBody.prototype, \"onbeforeremove\", function (this: ComposerBody, r: any) {\r\n        if (!app.forum.attribute(\"xyppWsnTypeTip\")) {\r\n            return;\r\n        }\r\n        if ((app.session?.user?.preferences() || {})[\"xyppWsnNoTypeTip\"]) {\r\n            return;\r\n        }\r\n        if ((this.attrs as any).discussion)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"session\")\r\n                    .add(\"release\")\r\n                    .add(\"discussion\", (this.attrs as any).discussion.id())\r\n                    .add(\"typing\")\r\n                );\r\n        if ((this.attrs as any).post)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"session\")\r\n                    .add(\"release\")\r\n                    .add(\"discussion\", (this.attrs as any).post.discussion().id())\r\n                    .add(\"typing\")\r\n                );\r\n    });\r\n    extend(DiscussionPage.prototype, \"show\", function (this: DiscussionPage, r: any, discussion: Discussion) {\r\n        const typings: {\r\n            user: { data: any }[]\r\n        } = discussion.attribute(\"typeTip\");\r\n        //@ts-ignore\r\n        discussion.typingUsers = [];\r\n        for (const user of typings.user) {\r\n            let u: User | undefined = app.store.getById<User>(\"users\", user.data.id);\r\n            if (!u) {\r\n                u = app.store.pushPayload<User>(user);\r\n            }\r\n            //@ts-ignore\r\n            discussion.typingUsers.push(u);\r\n        }\r\n    })\r\n    extend(PostStream.prototype, \"endItems\", function (this: PostStream, items: ItemList<any>) {\r\n        if (this.discussion.typingUsers.length)\r\n            items.add(\"typings\", TypingTip.component({\r\n                typingUsers: this.discussion.typingUsers,\r\n                key: \"typingTip\"\r\n            }));\r\n    });\r\n\r\n    extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n        items.add(\r\n            'xypp-wsn-typing-option',\r\n            <FieldSet label={app.translator.trans(\"xypp-websocket-notification.forum.typing.title\")} className=\"Settings-typing\">\r\n                <p><Switch\r\n                    state={((app.session?.user?.preferences() || {})[\"xyppWsnNoTypeTip\"] || false)}\r\n                    onchange={(v: boolean) => {\r\n                        app.session?.user?.savePreferences({\r\n                            \"xyppWsnNoTypeTip\": v\r\n                        });\r\n                    }}\r\n                >{app.translator.trans(\"xypp-websocket-notification.forum.typing.no_type_tip\")}</Switch></p>\r\n            </FieldSet>\r\n        );\r\n    })\r\n\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\n\r\nexport function initReaction() {\r\n\r\n    addSubscribeCb(\"reaction\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussion) {\r\n            items.add(\"reaction\", new ModelPath().add(\"discussion\", context.discussion).add(\"post\").add(\"reaction\"));\r\n        }\r\n    });\r\n\r\n    addMessageCb(\"reaction\", (path: ModelPath, data: any) => {\r\n        if (path.getId(\"post\")) {\r\n            const post = app.store.getById<Post>(\"posts\", path.getId(\"post\") as string);\r\n            if (post) {\r\n                post.pushAttributes({ reactionCounts: data.counts });\r\n                post.freshness = new Date();\r\n                m.redraw();\r\n            }\r\n        }\r\n    })\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\nimport User from \"flarum/common/models/User\";\r\nimport { override } from \"flarum/common/extend\";\r\n\r\nexport function initOnline() {\r\n\r\n    addSubscribeCb(\"online\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        items.add(\"online\", new ModelPath().add(\"state\").add(\"online\"));\r\n    });\r\n\r\n    addMessageCb(\"online\", (path: ModelPath, data: any) => {\r\n        const id = path.getId(\"state\");\r\n        if (id) {\r\n            const model = app.store.getById<User>(\"users\", id);\r\n            if (model) {\r\n                model.pushAttributes({\r\n                    onlineState: data.state\r\n                });\r\n                m.redraw();\r\n            }\r\n        }\r\n    });\r\n\r\n    override(User.prototype, \"isOnline\", function (this: User, fn: () => boolean) {\r\n        const online = this.attribute(\"onlineState\");\r\n        if (online === false || online === true) return online;\r\n        return fn();\r\n    })\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\n\r\nexport function initPoll() {\r\n    addSubscribeCb(\"poll\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussion && flarum.extensions['fof-polls']) {\r\n            const discussion = app.store.getById<any>(\"discussions\", context.discussion);\r\n            if (discussion.hasPoll()) {\r\n                discussion.posts().forEach((post: any) => {\r\n                    const poll = post.polls();\r\n                    if (poll && poll.length) {\r\n                        poll.forEach((p: any) => {\r\n                            items.add(\"poll-\" + p.id(), new ModelPath().add(\"poll\", p.id()));\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    addMessageCb(\"poll\", (path: ModelPath, data: any) => {\r\n        let count = 0;\r\n        Object.keys(data).forEach(key => {\r\n            const pollOption = app.store.getById<any>(\"poll_options\", key);\r\n            if (pollOption) {\r\n                pollOption.pushAttributes({\r\n                    voteCount: data[key]\r\n                });\r\n                count += data[key];\r\n            }\r\n        });\r\n        const poll = app.store.getById(\"polls\", path.getId() as string);\r\n        poll?.pushAttributes({ \"voteCount\": count });\r\n        m.redraw();\r\n    })\r\n}","import Component from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport Button from \"flarum/common/components/Button\"\r\nimport { WebsocketHelper } from \"../../common\";\r\nimport { STATUS } from \"../../common/helper/WebsocketHelper\";\r\n\r\nexport default class ConnectionIndicator extends Component {\r\n    currentStatus: STATUS = \"offline\";\r\n    oninit(vnode: any): void {\r\n        super.oninit(vnode);\r\n        WebsocketHelper.getInstance().onStatusChange(this.status.bind(this))\r\n    }\r\n    view(vnode: any) {\r\n        return this.getContent();\r\n    }\r\n    getContent() {\r\n        switch (this.currentStatus) {\r\n            case \"online\":\r\n                return <span className=\"connectionIndicator-icon online\">\r\n                    <i className=\"far fa-circle\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.connected\")}\r\n                </span>;\r\n            case \"offline\":\r\n                return <span className=\"connectionIndicator-icon offline\">\r\n                    <i className=\"fas fa-times\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.disconnected\")}\r\n                </span>;\r\n            case \"connecting\":\r\n                return <span className=\"connectionIndicator-icon connecting\">\r\n                    <i className=\"fas fa-wifi\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.connecting\")}\r\n                </span>;\r\n            case \"partial\":\r\n                return <span className=\"connectionIndicator-icon partial\">\r\n                    <i className=\"fas fa-circle\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.partial\")}\r\n                </span>;\r\n        }\r\n    }\r\n    status(status: STATUS) {\r\n        this.currentStatus = status;\r\n        m.redraw();\r\n    }\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/HeaderSecondary'];","import app from 'flarum/forum/app';\nimport WebsocketAccessToken from '../common/model/WebsocketAccessToken';\nimport { WebsocketHelper } from '../common/helper/WebsocketHelper';\nimport init from './integration';\nimport PageState from 'flarum/common/states/PageState';\nimport { extend } from 'flarum/common/extend';\nimport ConnectionIndicator from './components/ConnectionIndicator';\nimport HeaderSecondary from 'flarum/forum/components/HeaderSecondary';\nimport { initUnreadTip } from './utils/unreadTip';\n\napp.initializers.add('xypp/flarum-websocket-notification', () => {\n  WebsocketHelper.getInstance().init(app);\n  init();\n  setTimeout(() => {\n    WebsocketHelper.getInstance().start();\n  }, 0);\n  extend(HeaderSecondary.prototype, 'items', function (items) {\n    items.add('wsn', ConnectionIndicator.component(), 1000);\n  });\n  initUnreadTip();\n});"],"names":["module","exports","e","n","r","i","s","u","a","o","c","f","h","d","l","$","y","M","name","weekdays","split","months","ordinal","t","m","String","length","Array","join","v","z","utcOffset","Math","abs","floor","date","year","month","clone","add","ceil","p","w","D","ms","Q","toLowerCase","replace","g","S","_","O","args","arguments","b","locale","$L","utc","$u","x","$x","$offset","this","parse","prototype","$d","Date","NaN","test","match","substring","UTC","init","$y","getFullYear","$M","getMonth","$D","getDate","$W","getDay","$H","getHours","$m","getMinutes","$s","getSeconds","$ms","getMilliseconds","$utils","isValid","toString","isSame","startOf","endOf","isAfter","isBefore","$g","set","unix","valueOf","getTime","toDate","apply","slice","$locale","weekStart","$set","min","daysInMonth","get","Number","round","subtract","format","invalidDate","meridiem","monthsShort","weekdaysMin","weekdaysShort","getTimezoneOffset","diff","toJSON","toISOString","toUTCString","k","forEach","extend","$i","isDayjs","en","Ls","_typeof","require","_regeneratorRuntime","__esModule","Object","hasOwnProperty","defineProperty","value","Symbol","iterator","asyncIterator","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","values","defineIteratorMethods","_invoke","AsyncIterator","invoke","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","definition","key","obj","prop","flarum","core","compat","_setPrototypeOf","bind","_inheritsLoose","WebsocketAccessToken","_Model","_this","_len","_key","concat","token","Model","url","location","hostname","Extend","asyncGeneratorStep","ModelPath","str","nodes","data","endsWith","JSON","map","ret","includes","_n$split","id","_proto","stringify","find","getId","node","remove","index","findIndex","splice","getData","setData","RETRY_INTERVALS","WebsocketHelper","app","ws","statusChangeCb","lastConnected","firstSubscribe","context","lastSubscribes","pingInterval","nextRetry","inRetryStatus","sendInConnecting","getInstance","instance","dayjs","start","_start","_callee","item","_context","onclose","close","store","createRecord","save","t0","retry","WebSocket","clearInterval","onerror","onopen","reSubscribe","setInterval","ping","send","onmessage","messageHandler","path","_next","_throw","console","log","getSubscribes","ItemList","setContext","_this2","tempContext","newSub","assign","toArray","changed","restore","state","_this$app","session","user","readyState","CONNECTING","OPEN","onStatusChange","cb","_this3","setTimeout","sort","localeCompare","addSubscribeCb","addMessageCb","override","orig","_path$get","showIf","judgement","vnode","def","NotificationFloater","_Component","view","_app$session","position","preferences","className","attrs","notifications","notification","attributes","contentType","cls","first","Button","onclick","dismiss","trans","Component","WrappedFlagNotification","flag","post","Link","href","redraw","avatar","icon","username","em","discussion","title","humanTime","createdAt","contentPlain","unreadCount","addUnread","document","hasFocus","ComingDiscussion","autoRefreshTimeout","autoRefresh","countdown","oncreate","xyppWsnNewDiscussionAutoRefresh","updateCtd","onbeforeremove","list","class","count","near","callback","TypingTip","MAX_LIST_LEN","parseInt","attribute","typingUsers","rest","items","_app$session2","isAdmin","_app$session$user$unr","_app$session$user$new","time","pushPayload","unshift","pushAttributes","unreadNotificationCount","newNotificationCount","_app$flags","model","cache","isArray","flagCount","ctr","addClass","appendTo","body","mount","component","element","SELECT_FLOATER","SettingsPage","_app$session3","FieldSet","label","Select","options","onchange","savePreferences","wrappedFlag","initNotification","_ref","route","routeName","stream","viewingEnd","relationships","posts","loadNext","removeStack","DiscussionPage","initPost","discussionList","discussionListTag","tag","getBy","comingDiscussions","toPullUpDiscussions","idx","_app$current","baseCount","exist","_app$current2","maxLen","addOne","DiscussionList","children","addDiscussion","params","tags","savingList","_app$session4","Switch","_app$session5","preventDefault","val","disabled","loading","initDiscussionList","getById","like","likes","freshness","typings","restTypingUsers","ComposerBody","_app$session6","_step","_iterator","_createForOfIteratorHelperLoose","PostStream","_app$session7","_app$session8","reactionCounts","counts","onlineState","User","fn","online","extensions","hasPoll","poll","polls","pollOption","voteCount","ConnectionIndicator","currentStatus","oninit","status","getContent","HeaderSecondary","window","addEventListener"],"sourceRoot":""}