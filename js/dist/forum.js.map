{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@xypp/flarum-websocket-notification/./src/common/Data/ModelPath.ts","webpack://@xypp/flarum-websocket-notification/./src/common/extend.ts","webpack://@xypp/flarum-websocket-notification/./src/common/helper/WebsocketHelper.ts","webpack://@xypp/flarum-websocket-notification/./src/common/index.ts","webpack://@xypp/flarum-websocket-notification/./src/common/model/WebsocketAccessToken.ts","webpack://@xypp/flarum-websocket-notification/./src/common/util/NodeUtil.ts","webpack://@xypp/flarum-websocket-notification/./src/common/util/frontend.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/components/ConnectionIndicator.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/index.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/ComingDiscussion.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/NotificationFloater.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/TypingTip.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/components/WrappedFlagNotification.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/discussionList.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/index.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/like.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/notification.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/online.tsx","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/poll.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/post.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/reaction.ts","webpack://@xypp/flarum-websocket-notification/./src/forum/integration/typing.tsx","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/Component']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/Model']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Button']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Link']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Select']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/extend']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/extenders']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/models/User']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/app']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/ComposerBody']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/PostStream']\"","webpack://@xypp/flarum-websocket-notification/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/regenerator/index.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@xypp/flarum-websocket-notification/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@xypp/flarum-websocket-notification/webpack/bootstrap","webpack://@xypp/flarum-websocket-notification/webpack/runtime/compat get default export","webpack://@xypp/flarum-websocket-notification/webpack/runtime/define property getters","webpack://@xypp/flarum-websocket-notification/webpack/runtime/hasOwnProperty shorthand","webpack://@xypp/flarum-websocket-notification/webpack/runtime/make namespace object","webpack://@xypp/flarum-websocket-notification/./forum.ts"],"sourcesContent":["type ModelPathNode = {\r\n    id?: string;\r\n    name: string;\r\n}\r\nexport class ModelPath {\r\n    nodes: ModelPathNode[];\r\n    data: any;\r\n    constructor(str?: string) {\r\n        if (str) {\r\n            if (str.endsWith(\"}\")) {\r\n                const t = str.split('||');\r\n                this.data = JSON.parse(t[1]);\r\n                str = t[0];\r\n            }\r\n            this.nodes = str.split('.').map(n => {\r\n                const ret: ModelPathNode = { name: n };\r\n                if (n.includes('[')) {\r\n                    const [name, id] = n.split('[');\r\n                    ret.id = id.substring(0, id.length - 1);\r\n                    ret.name = name;\r\n                }\r\n                return ret;\r\n            });\r\n        } else {\r\n            this.nodes = [];\r\n        }\r\n    }\r\n    toString(): string {\r\n        return this.nodes.map(n => n.id ? `${n.name}[${n.id}]` : n.name).join('.') + (this.data ? `||${JSON.stringify(this.data)}` : \"\");\r\n    }\r\n    add(name: string, id?: string): this {\r\n        this.nodes.push({ name, id });\r\n        return this;\r\n    }\r\n    get(name?: string): ModelPathNode | null {\r\n        if (!name) return this.nodes[this.nodes.length - 1] || null;\r\n        return this.nodes.find(n => n.name === name) || null;\r\n    }\r\n    getId(name?: string): string | null {\r\n        const node = this.get(name);\r\n        return node && (node.id || null);\r\n    }\r\n    remove(name: string): this {\r\n        const index = this.nodes.findIndex(n => n.name === name);\r\n        if (index >= 0) {\r\n            this.nodes.splice(index, 1);\r\n        }\r\n        return this;\r\n    }\r\n    getData(): any {\r\n        return this.data;\r\n    }\r\n    setData(data: any): this {\r\n        this.data = data;\r\n        return this;\r\n    }\r\n\r\n}","import Extend from 'flarum/common/extenders';\r\nimport WebsocketAccessToken from './model/WebsocketAccessToken';\r\nexport default [\r\n    new Extend.Store()\r\n        .add('websocket-access-token', WebsocketAccessToken)\r\n];","import AdminApplication from \"flarum/admin/AdminApplication\";\r\nimport ItemList from \"flarum/common/utils/ItemList\";\r\nimport ForumApplication from \"flarum/forum/ForumApplication\";\r\nimport { ModelPath } from \"../Data/ModelPath\";\r\nimport WebsocketAccessToken from \"../model/WebsocketAccessToken\";\r\nexport type STATUS = \"online\" | \"offline\" | \"connecting\";\r\n\r\nconst RETRY_INTERVALS = [100, 2000, 5000, 10000, 60000, 120000];\r\n\r\nexport class WebsocketHelper {\r\n    app?: ForumApplication | AdminApplication;\r\n    ws?: WebSocket\r\n    statusChangeCb?: (status: STATUS) => void;\r\n    context: Record<string, any> = {};\r\n    lastSubscribes: string[] = [];\r\n    pingInterval?: any;\r\n    nextRetry = 0;\r\n    inRetryStatus = false;\r\n    static instance?: WebsocketHelper;\r\n    public static getInstance(): WebsocketHelper {\r\n        if (!WebsocketHelper.instance) {\r\n            WebsocketHelper.instance = new WebsocketHelper();\r\n        }\r\n        return WebsocketHelper.instance;\r\n    }\r\n    init(app: ForumApplication | AdminApplication) {\r\n        this.app = app;\r\n    }\r\n    async start() {\r\n        if (this.app) {\r\n            if (this.ws) {\r\n                try {\r\n                    this.ws.onclose = () => { }\r\n                    this.ws.close();\r\n                } finally {\r\n                    this.ws = undefined;\r\n                };\r\n            }\r\n            if (this.statusChangeCb) this.statusChangeCb(\"connecting\");\r\n            let item: WebsocketAccessToken | null = null;\r\n            try {\r\n                item = await this.app.store.createRecord<WebsocketAccessToken>(\"websocket-access-token\").save({});\r\n            } catch (e) {\r\n                this.retry();\r\n            }\r\n            if (!item) {\r\n                this.retry();\r\n                return;\r\n            }\r\n            const ws = new WebSocket(item.url());\r\n            this.ws = ws;\r\n            ws.onclose = () => {\r\n                this.retry();\r\n                if (this.pingInterval)\r\n                    clearInterval(this.pingInterval);\r\n            }\r\n            ws.onerror = () => {\r\n                this.retry();\r\n                if (this.pingInterval)\r\n                    clearInterval(this.pingInterval);\r\n            }\r\n            ws.onopen = () => {\r\n                this.lastSubscribes = [];\r\n                this.reSubscribe();\r\n                this.pingInterval = setInterval(this.ping.bind(this), 30000);\r\n                if (this.statusChangeCb) this.statusChangeCb(\"online\");\r\n                this.nextRetry = 0;\r\n            }\r\n            ws.onmessage = (e) => {\r\n                const data = JSON.parse(e.data);\r\n                if (data.type === \"sync\")\r\n                    this.messageHandler(new ModelPath(data.path), data.data);\r\n            }\r\n        }\r\n    }\r\n    messageHandler(path: ModelPath, data: any) {\r\n        // To be implemented in extends\r\n        console.log(`No handler found ${path.toString()}: ${JSON.stringify(data)}`);\r\n    }\r\n    getSubscribes(context: Record<string, any>): ItemList<ModelPath> {\r\n        return new ItemList<ModelPath>();\r\n    }\r\n    setContext(context: Record<string, any>) {\r\n        Object.keys(context).forEach(v => {\r\n            if (context[v] === null && this.context[v]) delete this.context[v];\r\n            else this.context[v] = context[v];\r\n        });\r\n        return this;\r\n    }\r\n    reSubscribe(tempContext?: Record<string, any>) {\r\n        const newSub = this.getSubscribes(Object.assign(tempContext || {}, this.context)).toArray().map(v => v.toString());\r\n        console.log(`ReSubscribe: ${newSub.join(\", \")}`);\r\n        if (!this.changed(newSub)) return;\r\n        this.lastSubscribes = newSub;\r\n        this.send({\r\n            type: \"subscribe\",\r\n            path: newSub\r\n        });\r\n        return this;\r\n    }\r\n    state(path: ModelPath) {\r\n        if (!this.app?.session.user) return;\r\n        this.send({\r\n            type: \"state\",\r\n            path: path.toString()\r\n        })\r\n    }\r\n    send(data: { type: string, [key: string]: any }) {\r\n        if (this.ws) {\r\n            this.ws.send(JSON.stringify(data));\r\n        }\r\n    }\r\n    onStatusChange(cb: (status: STATUS) => void) {\r\n        this.statusChangeCb = cb;\r\n    }\r\n    retry() {\r\n        if (this.inRetryStatus) return;\r\n        this.inRetryStatus = true;\r\n        if (this.statusChangeCb) this.statusChangeCb(\"offline\");\r\n        setTimeout(() => {\r\n            this.inRetryStatus = false;\r\n            this.start();\r\n        }, RETRY_INTERVALS[this.nextRetry - 1]);\r\n        if (this.nextRetry < RETRY_INTERVALS.length) {\r\n            this.nextRetry += 1;\r\n        }\r\n    }\r\n    protected ping() {\r\n        this.send({\r\n            type: \"ping\"\r\n        });\r\n    }\r\n    protected changed(newSub: string[]): boolean {\r\n        newSub.sort((a, b) => a.localeCompare(b));\r\n        if (newSub.length !== this.lastSubscribes.length) return true;\r\n        for (let i = 0; i < newSub.length; i++) {\r\n            if (newSub[i] !== this.lastSubscribes[i]) return true;\r\n        }\r\n        return false;\r\n    }\r\n}","import { WebsocketHelper } from \"./helper/WebsocketHelper\";\r\n\r\nexport { WebsocketHelper };","import Model from 'flarum/common/Model';\n\nexport default class WebsocketAccessToken extends Model {\n  token = Model.attribute<string>('token');\n  url = Model.attribute<string>('url', (url?: any) => url && url.replace(\"0.0.0.0\", location.hostname));\n}","export function showIf(judgement: boolean, vnode: any, def?: any) {\n    return judgement ? vnode : (def || \"\");\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../Data/ModelPath\";\r\nimport { extend, override } from \"flarum/common/extend\"\r\nimport { WebsocketHelper } from \"../helper/WebsocketHelper\";\r\nexport function addSubscribeCb(name: string, cb: (items: ItemList<ModelPath>, context: Record<string, any>) => void) {\r\n    extend(WebsocketHelper.prototype, \"getSubscribes\", cb);\r\n}\r\nexport function addMessageCb(name: string, cb: (path: ModelPath, data: any) => void) {\r\n    override(WebsocketHelper.prototype, \"messageHandler\", function (orig: (path: ModelPath, data: any) => void, path: ModelPath, data: any) {\r\n        if (path.get()?.name == name) {\r\n            return cb(path, data);\r\n        }\r\n        orig(path, data);\r\n    });\r\n}\r\n","import Component from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport Button from \"flarum/common/components/Button\"\r\nimport { WebsocketHelper } from \"../../common\";\r\nimport { STATUS } from \"../../common/helper/WebsocketHelper\";\r\n\r\nexport default class ConnectionIndicator extends Component {\r\n    currentStatus: STATUS = \"offline\";\r\n    oninit(vnode: any): void {\r\n        super.oninit(vnode);\r\n        WebsocketHelper.getInstance().onStatusChange(this.status.bind(this))\r\n    }\r\n    view(vnode: any) {\r\n        return this.getContent();\r\n    }\r\n    getContent() {\r\n        switch (this.currentStatus) {\r\n            case \"online\":\r\n                return <span className=\"connectionIndicator-icon online\">\r\n                    <i className=\"far fa-circle\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.connected\")}\r\n                </span>;\r\n            case \"offline\":\r\n                return <span className=\"connectionIndicator-icon offline\">\r\n                    <i className=\"fas fa-times\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.disconnected\")}\r\n                </span>;\r\n            case \"connecting\":\r\n                return <span className=\"connectionIndicator-icon connecting\">\r\n                    <i className=\"fas fa-wifi\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.connection.connecting\")}\r\n                </span>;\r\n        }\r\n    }\r\n    status(status: STATUS) {\r\n        this.currentStatus = status;\r\n        m.redraw();\r\n    }\r\n}","import app from 'flarum/forum/app';\nimport WebsocketAccessToken from '../common/model/WebsocketAccessToken';\nimport { WebsocketHelper } from '../common/helper/WebsocketHelper';\nimport init from './integration';\nimport PageState from 'flarum/common/states/PageState';\nimport { extend } from 'flarum/common/extend';\nimport ConnectionIndicator from './components/ConnectionIndicator';\n\napp.initializers.add('xypp/flarum-websocket-notification', () => {\n  WebsocketHelper.getInstance().init(app);\n  init();\n  setTimeout(() => {\n    WebsocketHelper.getInstance().start();\n  }, 1000);\n  (window as any).navigation.addEventListener(\"navigate\", (event: any) => {\n    WebsocketHelper.getInstance().reSubscribe();\n  });\n\n\n  const ctr = $(\"<div></div>\").addClass(\"connectionIndicator\")\n  ctr.appendTo(document.body);\n  m.mount(ctr[0], { view: function () { return ConnectionIndicator.component() } });\n});\n\n","import Component from \"flarum/common/Component\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport app from \"flarum/forum/app\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport Link from \"flarum/common/components/Link\"\r\nimport { showIf } from \"../../../common/util/NodeUtil\";\r\nexport default class ComingDiscussion extends Component<{\r\n    list: {\r\n        title: string,\r\n        id: string,\r\n        count: number,\r\n        post: number\r\n    }[],\r\n    cb: () => void\r\n}> {\r\n    autoRefreshTimeout: any = null;\r\n    autoRefresh: boolean = false;\r\n    countdown: number = 30;\r\n    oncreate(vnode: any): void {\r\n        super.oncreate(vnode);\r\n        this.autoRefresh = app.session?.user?.preferences()?.xyppWsnNewDiscussionAutoRefresh || false;\r\n        if (this.autoRefresh) {\r\n            this.autoRefreshTimeout = setInterval(() => {\r\n                this.updateCtd();\r\n            }, 1000);\r\n        }\r\n    }\r\n    onbeforeremove(vnode: any): void {\r\n        super.onbeforeremove(vnode);\r\n        if (this.autoRefreshTimeout) {\r\n            clearInterval(this.autoRefreshTimeout);\r\n        }\r\n    }\r\n    view(vnode: any) {\r\n        return <div className=\"ComingDiscussion\">\r\n            <div className=\"ComingDiscussion-icon\">\r\n                <i className=\"fas fa-star-of-life\"></i>\r\n                <div className=\"ComingDiscussion-icon-text\">\r\n                    {app.translator.trans('xypp-websocket-notification.forum.new_discussion.tip')}\r\n                </div>\r\n            </div>\r\n            <div className=\"ComingDiscussion-item-container\">\r\n                {\r\n                    this.attrs.list.map(item => {\r\n                        return <div class=\"ComingDiscussion-item\">\r\n                            <span className=\"ComingDiscussion-count\">{item.count}</span>\r\n                            <Link className=\"ComingDiscussion-link\" href={app.route(\"discussion.near\", {\r\n                                id: item.id,\r\n                                near: item.post\r\n                            })}>{item.title}</Link>\r\n                        </div>\r\n                    })\r\n                }\r\n            </div>\r\n            <div className=\"ComingDiscussion-Reload\">\r\n                <Button class=\"Button\" onclick={this.callback.bind(this)}><i className=\"fas fa-sync\"></i></Button>\r\n                {showIf(this.autoRefresh, <div className=\"autoReloadIndicator\">{this.countdown}</div>)}\r\n            </div>\r\n        </div>\r\n    }\r\n    callback() {\r\n        if (this.autoRefreshTimeout) {\r\n            clearInterval(this.autoRefreshTimeout);\r\n            this.autoRefreshTimeout = null;\r\n            this.autoRefresh = false;\r\n        }\r\n        this.attrs.cb();\r\n    }\r\n    updateCtd() {\r\n        if (this.countdown > 0) {\r\n            this.countdown--;\r\n            if (this.countdown == 0) {\r\n                this.callback();\r\n            }\r\n            m.redraw();\r\n        }\r\n    }\r\n}","import Component from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport { showIf } from \"../../../common/util/NodeUtil\";\r\nimport Button from \"flarum/common/components/Button\"\r\n\r\nexport default class NotificationFloater extends Component<{\r\n    notifications: { time: number, first: boolean, notification: any }[],\r\n    dismiss: () => void\r\n}> {\r\n    view(vnode: any) {\r\n        const position = (app.session?.user?.preferences() || {})[\"xyppWsnFloaterPosition\"] || \"center\";\r\n        return <div className={showIf(this.attrs.notifications.length > 0, \"notification-floater\", \"notification-floater hidden\") + \" \" + position}>\r\n            {this.attrs.notifications.map(n => {\r\n                const type = n.notification.data.attributes.contentType;\r\n                const cls = app.notificationComponents[type];\r\n                return <div className={showIf(n.first, \"notification-floater-item in\", \"notification-floater-item\")}>\r\n                    {showIf(!!cls, m(cls, { notification: n.notification }), <div>{type}</div>)}\r\n                </div>\r\n            })}\r\n            <div className=\"notification-floater-close-container\">\r\n                <Button className=\"Button Button-primary\" onclick={this.attrs.dismiss}>\r\n                    <i className=\"fas fa-times\"></i>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.close_notification_floater\")}\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    }\r\n}","import Component from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport { showIf } from \"../../../common/util/NodeUtil\";\r\nimport Button from \"flarum/common/components/Button\"\r\nimport User from \"flarum/common/models/User\";\r\nimport avatar from \"flarum/common/helpers/avatar\"\r\nimport username from \"flarum/common/helpers/username\"\r\nimport Link from \"flarum/common/components/Link\";\r\nconst MAX_LIST_LEN = 1;\r\nexport default class TypingTip extends Component<{\r\n    typingUsers: User[]\r\n}> {\r\n    view(vnode: any) {\r\n        if (!this.attrs.typingUsers.length) {\r\n            return <div>{app.translator.trans(\"xypp-websocket-notification.forum.typing.no_one\")}</div>\r\n        }\r\n        return <div className=\"PostStream-item\">\r\n            <div className=\"LineContainer\">\r\n                <div className=\"users\">\r\n                    {this.attrs.typingUsers.slice(0, MAX_LIST_LEN).map(u => <Link className=\"typingUser\" href={app.route.user(u)}>\r\n                        {avatar(u)}\r\n                        <span className=\"username\">{username(u)}</span>\r\n                    </Link>)}\r\n                </div>\r\n                {showIf(this.attrs.typingUsers.length > MAX_LIST_LEN, <div>\r\n                    {app.translator.trans(\"xypp-websocket-notification.forum.typing.and_more\", { rest: this.attrs.typingUsers.length - MAX_LIST_LEN })}\r\n                </div>)}\r\n                <div>{app.translator.trans(\"xypp-websocket-notification.forum.typing.is_typing\")}</div>\r\n            </div>\r\n        </div>\r\n    }\r\n}","import Component from \"flarum/common/Component\";\r\nimport Link from \"flarum/common/components/Link\";\r\nimport app from \"flarum/forum/app\";\r\nimport avatar from \"flarum/common/helpers/avatar\";\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport username from \"flarum/common/helpers/username\";\r\nimport humanTime from \"flarum/common/helpers/humanTime\";\r\nexport default class WrappedFlagNotification extends Component<{\r\n    notification: any\r\n}> {\r\n    view() {\r\n        const flag = this.attrs.notification.data.attributes.flag;\r\n        const post = flag.post();\r\n        return <Link\r\n            href={app.route.post(post)}\r\n            className=\"Notification Flag\"\r\n            onclick={(e: any) => {\r\n                (app.flags as any).index = post;\r\n                e.redraw = false;\r\n            }}\r\n        >\r\n            {avatar(post.user())}\r\n            {icon('fas fa-flag', { className: 'Notification-icon' })}\r\n            <span className=\"Notification-content\">\r\n                {app.translator.trans('flarum-flags.forum.flagged_posts.item_text', {\r\n                    username: username(post.user()),\r\n                    em: <em />,\r\n                    discussion: post.discussion().title(),\r\n                })}\r\n            </span>\r\n            {humanTime(flag.createdAt())}\r\n            <div className=\"Notification-excerpt\">{post.contentPlain()}</div>\r\n        </Link>\r\n    }\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport app from \"flarum/forum/app\";\r\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\"\r\nimport { extend } from \"flarum/common/extend\";\r\nimport { WebsocketHelper } from \"../../common/helper/WebsocketHelper\";\r\nimport DiscussionList from \"flarum/forum/components/DiscussionList\"\r\nimport ComingDiscussion from \"./components/ComingDiscussion\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport FieldSet from \"flarum/common/components/FieldSet\";\r\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\r\nimport Switch from \"flarum/common/components/Switch\";\r\nimport Button from \"flarum/common/components/Button\";\r\nexport function initDiscussionList() {\r\n    addSubscribeCb(\"discussion\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussionList) {\r\n            if (context.discussionListTag) {\r\n                const tag = app.store.getBy<any>(\"tags\", \"slug\", context.discussionListTag);\r\n                if (tag) {\r\n                    items.add(\"discussionList\", new ModelPath().add(\"tag\", tag.id()).add(\"discussion\"));\r\n                }\r\n            } else {\r\n                items.add(\"discussionList\", new ModelPath().add(\"discussion\"));\r\n            }\r\n        }\r\n    })\r\n    let comingDiscussions: {\r\n        title: string;\r\n        post: number;\r\n        id: string;\r\n        count: number;\r\n    }[] = [];\r\n    let toPullUpDiscussions: Discussion[] = [];\r\n    function refresh() {\r\n        toPullUpDiscussions.forEach(app.discussions.addDiscussion.bind(app.discussions));\r\n\r\n        comingDiscussions = [];\r\n        toPullUpDiscussions = [];\r\n        m.redraw();\r\n    }\r\n    function addOne(id: string, title: string, post: number) {\r\n        if ((app.current?.data as any)?.discussion?.id() == id) return;\r\n        let baseCount = 0;\r\n        for (let i = 0; i < comingDiscussions.length; i++) {\r\n            if (comingDiscussions[i].id == id) {\r\n                baseCount = comingDiscussions[i].count;\r\n                comingDiscussions.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n        comingDiscussions.unshift({\r\n            title: title,\r\n            post: post,\r\n            id: id,\r\n            count: baseCount + 1\r\n        });\r\n        const maxLen = (app.session?.user?.preferences() || {})[\"xyppWsnNewDiscussionListLen\"] || 5;\r\n        if (comingDiscussions.length > maxLen) {\r\n            comingDiscussions.pop();\r\n        }\r\n    }\r\n\r\n    addMessageCb(\"discussion\", (path: ModelPath, data: any) => {\r\n        const discussion: Discussion = app.store.pushPayload<Discussion>(data.discussion);\r\n        const idx = toPullUpDiscussions.findIndex(d => d.id() == discussion.id());\r\n        if (idx != -1) {\r\n            toPullUpDiscussions.splice(idx, 1);\r\n        }\r\n        toPullUpDiscussions.push(discussion);\r\n        addOne(discussion.id() as string, discussion.title(), data.post);\r\n        m.redraw();\r\n    });\r\n\r\n\r\n\r\n    extend(DiscussionList.prototype, \"view\", function (this: DiscussionList, vnode: any) {\r\n        if (comingDiscussions.length && vnode && vnode.children && Array.isArray(vnode.children)) {\r\n            vnode.children.unshift(ComingDiscussion.component({\r\n                list: comingDiscussions,\r\n                cb: (() => {\r\n                    refresh();\r\n                }).bind(this)\r\n            }));\r\n        }\r\n    })\r\n    extend(DiscussionList.prototype, \"oncreate\", function (this: DiscussionList) {\r\n        const tag = (this.attrs as any).state.params.tags;\r\n        WebsocketHelper.getInstance().setContext({\r\n            discussionListTag: tag,\r\n            discussionList: true\r\n        }).reSubscribe();\r\n    });\r\n    extend(DiscussionList.prototype, \"onbeforeremove\", () => {\r\n        WebsocketHelper.getInstance().setContext({\r\n            discussionList: null\r\n        }).reSubscribe();\r\n    });\r\n\r\n\r\n    extend(DiscussionPage.prototype, \"show\", function (this: DiscussionPage, r: any, discussion: Discussion) {\r\n        if (discussion)\r\n            for (let i = comingDiscussions.length - 1; i >= 0; i--) {\r\n                if (comingDiscussions[i].id == discussion.id()) {\r\n                    comingDiscussions.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n    })\r\n\r\n\r\n    let savingList = false;\r\n    extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n        items.add(\r\n            'xypp-wsn-newPostOption',\r\n            <FieldSet label={app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.title\")} className=\"Settings-newPost\">\r\n                <p><Switch\r\n                    state={((app.session?.user?.preferences() || {})[\"xyppWsnNewDiscussionAutoRefresh\"] || false)}\r\n                    onchange={(v: boolean) => {\r\n                        app.session?.user?.savePreferences({\r\n                            \"xyppWsnNewDiscussionAutoRefresh\": v\r\n                        });\r\n                    }}\r\n                >{app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.auto_refresh\")}</Switch></p>\r\n                <p>{app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.list_length\")}</p>\r\n                <div>\r\n                    <input\r\n                        id=\"input-xyppWsnNewDiscussionListLen\"\r\n                        className=\"FormControl\"\r\n                        type=\"number\"\r\n                        value={((app.session?.user?.preferences() || {})[\"xyppWsnNewDiscussionListLen\"] || 5)}\r\n                    />\r\n                    <Button onclick={((e: any) => {\r\n                        e.preventDefault();\r\n                        savingList = true;\r\n                        m.redraw();\r\n                        app.session?.user?.savePreferences({\r\n                            \"xyppWsnNewDiscussionListLen\": parseInt($(\"#input-xyppWsnNewDiscussionListLen\").val() as string)\r\n                        }).then(() => {\r\n                            savingList = false;\r\n                            m.redraw();\r\n                        });\r\n                    })} disabled={savingList} loading={savingList}>{app.translator.trans(\"xypp-websocket-notification.forum.new_discussion.list_len_button\")}</Button>\r\n                </div>\r\n            </FieldSet>\r\n        );\r\n    })\r\n}","import app from \"flarum/forum/app\";\r\nimport { initNotification } from \"./notification\";\r\nimport { initPost } from \"./post\";\r\nimport { initDiscussionList } from \"./discussionList\";\r\nimport { initLike } from \"./like\";\r\nimport { initTypingTip } from \"./typing\";\r\nimport { initReaction } from \"./reaction\";\r\nimport { initOnline } from \"./online\";\r\nimport { initPoll } from \"./poll\";\r\n\r\nexport default function init() {\r\n    initNotification();\r\n    initPost();\r\n    initDiscussionList();\r\n    initLike();\r\n    initTypingTip();\r\n    initReaction();\r\n    initOnline();\r\n    initPoll();\r\n}","import app from \"flarum/forum/app\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\n\r\nexport function initLike() {\r\n    addSubscribeCb(\"like\", (items, context) => {\r\n        if (context.discussion) {\r\n            items.add(\"like\", new ModelPath().add(\"discussion\", context.discussion).add(\"post\").add(\"like\"));\r\n        }\r\n    });\r\n    addMessageCb(\"like\", (path, data) => {\r\n        const post = app.store.getById(\"posts\", data.post);\r\n        if (!app.store.getById(\"users\", data.user.data.id)) {\r\n            app.store.pushPayload(data.user);\r\n        }\r\n        if (post) {\r\n            const like: { data: { type: string, id: string }[] } = (post.data.relationships as any).likes;\r\n            for (let i = 0; i < like.data.length; i++) {\r\n                if (like.data[i].id == data.user.data.id) {\r\n                    if (!data.like) {\r\n                        like.data.splice(i, 1);\r\n                        post.freshness=new Date();\r\n                        m.redraw();\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n            if (data.like) {\r\n                like.data.push({\r\n                    type: \"users\",\r\n                    id: data.user.data.id\r\n                });\r\n                post.freshness=new Date();\r\n                m.redraw();\r\n            }\r\n        }\r\n    })\r\n}","import app from \"flarum/forum/app\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport NotificationFloater from \"./components/NotificationFloater\";\r\nimport { extend } from \"flarum/common/extend\";\r\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\r\nimport FieldSet from \"flarum/common/components/FieldSet\"\r\nimport Select from \"flarum/common/components/Select\";\r\nimport WrappedFlagNotification from \"./components/WrappedFlagNotification\";\r\nexport function initNotification() {\r\n  let notifications: { time: number, first: boolean, notification: any }[] = [];\r\n  addSubscribeCb('notification', (items) => {\r\n    if (app.session?.user)\r\n      items.add(\"notification\", new ModelPath().add(\"notification\", app.session.user.id()));\r\n    if (app.session?.user?.isAdmin()) {\r\n      items.add(\"flag\", new ModelPath().add(\"flag\"));\r\n    }\r\n  });\r\n  addMessageCb('notification', (path, data) => {\r\n    const model = app.store.pushPayload(data);\r\n    const obj = { time: 8, first: false, notification: model };\r\n    notifications.unshift(obj);\r\n    if (app.session.user)\r\n      app.session.user.pushAttributes({\r\n        unreadNotificationCount: app.session.user.unreadNotificationCount() ?? 0 + 1,\r\n        newNotificationCount: app.session.user.newNotificationCount() ?? 0 + 1,\r\n      });\r\n    m.redraw();\r\n    setTimeout(() => {\r\n      obj.first = true;\r\n      m.redraw();\r\n    }, 100);\r\n  });\r\n  addMessageCb('flag', (path, data) => {\r\n    const model = app.store.pushPayload(data);\r\n    const notification = {\r\n      data: { attributes: { contentType: \"wrappedFlag\", flag: model } }\r\n    }\r\n    const obj = { time: 8, first: false, notification };\r\n    notifications.unshift(obj);\r\n    if (app.flags?.cache && Array.isArray(app.flags.cache)) {\r\n      app.flags.cache.unshift(model);\r\n    }\r\n    (app.forum.data.attributes as any).flagCount++;\r\n    m.redraw();\r\n    setTimeout(() => {\r\n      obj.first = true;\r\n      m.redraw();\r\n    }, 100);\r\n  });\r\n  function dismiss() {\r\n    while (notifications.length) {\r\n      notifications.pop();\r\n    }\r\n  }\r\n\r\n  const ctr = $(\"<div></div>\").addClass(\"notification-floater-container\")\r\n  ctr.appendTo(document.body);\r\n  m.mount(ctr[0], { view: function () { return NotificationFloater.component({ notifications, dismiss }) } });\r\n\r\n  setInterval(() => {\r\n    notifications.forEach(element => {\r\n      element.time--;\r\n    });\r\n    let changed = false;\r\n    for (let i = notifications.length - 1; i >= 0; i--) {\r\n      if (notifications[i].time <= 0) {\r\n        notifications.splice(i, 1);\r\n        changed = true;\r\n      }\r\n    }\r\n    if (changed)\r\n      m.redraw();\r\n  }, 1000);\r\n\r\n  const SELECT_FLOATER = {\r\n    \"left\": app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.left\"),\r\n    \"right\": app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.right\"),\r\n    \"center\": app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.center\")\r\n  }\r\n  extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n    const position = (app.session?.user?.preferences() || {})[\"xyppWsnFloaterPosition\"] || \"center\";\r\n    items.add(\r\n      'xypp-wsn-floater-position',\r\n      <FieldSet label={app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.title\")} className=\"Settings-floater\">\r\n        <p>{app.translator.trans(\"xypp-websocket-notification.forum.notification_floater.desc\")}</p>\r\n        <Select\r\n          options={SELECT_FLOATER}\r\n          value={position}\r\n          onchange={(value: string) => {\r\n            app.session.user!\r\n              .savePreferences({\r\n                \"xyppWsnFloaterPosition\": value\r\n              });\r\n          }}\r\n        />\r\n      </FieldSet>\r\n    );\r\n  })\r\n\r\n  app.notificationComponents.wrappedFlag = WrappedFlagNotification as any;\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\nimport User from \"flarum/common/models/User\";\r\nimport { override } from \"flarum/common/extend\";\r\n\r\nexport function initOnline() {\r\n\r\n    addSubscribeCb(\"online\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        items.add(\"online\", new ModelPath().add(\"state\").add(\"online\"));\r\n    });\r\n\r\n    addMessageCb(\"online\", (path: ModelPath, data: any) => {\r\n        const id = path.getId(\"state\");\r\n        if (id) {\r\n            const model = app.store.getById<User>(\"users\", id);\r\n            if (model) {\r\n                model.pushAttributes({\r\n                    onlineState: data.state\r\n                });\r\n                m.redraw();\r\n            }\r\n        }\r\n    });\r\n\r\n    override(User.prototype, \"isOnline\", function (this: User, fn: () => boolean) {\r\n        const online = this.attribute(\"onlineState\");\r\n        if (online === false || online === true) return online;\r\n        return fn();\r\n    })\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\n\r\nexport function initPoll() {\r\n    addSubscribeCb(\"poll\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussion && flarum.extensions['fof-polls']) {\r\n            const discussion = app.store.getById<any>(\"discussions\", context.discussion);\r\n            if (discussion.hasPoll()) {\r\n                discussion.posts().forEach((post: any) => {\r\n                    const poll = post.polls();\r\n                    if (poll && poll.length) {\r\n                        poll.forEach((p: any) => {\r\n                            items.add(\"poll-\" + p.id(), new ModelPath().add(\"poll\", p.id()));\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    addMessageCb(\"poll\", (path: ModelPath, data: any) => {\r\n        let count = 0;\r\n        Object.keys(data).forEach(key => {\r\n            const pollOption = app.store.getById<any>(\"poll_options\", key);\r\n            if (pollOption) {\r\n                pollOption.pushAttributes({\r\n                    voteCount: data[key]\r\n                });\r\n                count += data[key];\r\n            }\r\n        });\r\n        const poll = app.store.getById(\"polls\", path.getId() as string);\r\n        poll?.pushAttributes({ \"voteCount\": count });\r\n        m.redraw();\r\n    })\r\n}","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport PostStreamState from \"flarum/forum/states/PostStreamState\"\r\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\"\r\nimport { extend } from \"flarum/common/extend\";\r\nimport { WebsocketHelper } from \"../../common/helper/WebsocketHelper\";\r\nimport PageState from \"flarum/common/states/PageState\";\r\nexport function initPost() {\r\n    addSubscribeCb(\"post\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussion) {\r\n            items.add(\"discussion\", new ModelPath().add(\"discussion\", context.discussion).add(\"post\"));\r\n        }\r\n    })\r\n    addMessageCb(\"post\", (path: ModelPath, data: any) => {\r\n        const route = ((app.current.data as any) ?? {}).routeName;\r\n        if (route !== \"discussion\" && route !== \"discussion.near\") return;\r\n        const discussion: Discussion = (app.current.data as any).discussion;\r\n        const stream: PostStreamState = app.current.get(\"stream\");\r\n        if (discussion.id() == path.getId(\"discussion\") && stream.viewingEnd()) {\r\n            const model = app.store.pushPayload<Post>(data);\r\n            if (!((discussion.data as any).relationships.posts.data.find((v: any) => v.id == model.id()))) {\r\n                (discussion.data as any).relationships.posts.data.push({ type: 'posts', id: model.id() });\r\n                stream.loadNext();\r\n            } else {\r\n                m.redraw();\r\n            }\r\n        }\r\n    });\r\n    let removeStack = 0;\r\n    extend(DiscussionPage.prototype, \"show\", function (this: DiscussionPage, r: any, discussion: Discussion) {\r\n        if (discussion) {\r\n            removeStack++;\r\n            WebsocketHelper.getInstance().setContext({\r\n                discussion: discussion!.id()\r\n            }).reSubscribe();\r\n        }\r\n    })\r\n    extend(DiscussionPage.prototype, \"onbeforeremove\", function (this: DiscussionPage) {\r\n        if (this.discussion) {\r\n            removeStack--;\r\n            if (removeStack < 0) removeStack = 0;\r\n            if (removeStack == 0)\r\n                WebsocketHelper.getInstance().setContext({\r\n                    discussion: null\r\n                }).reSubscribe();\r\n        }\r\n    })\r\n}\r\n","import ItemList from \"flarum/common/utils/ItemList\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport app from \"flarum/forum/app\";\r\nimport Post from \"flarum/common/models/Post\";\r\n\r\nexport function initReaction() {\r\n\r\n    addSubscribeCb(\"reaction\", (items: ItemList<ModelPath>, context: Record<string, any>) => {\r\n        if (context.discussion) {\r\n            items.add(\"reaction\", new ModelPath().add(\"discussion\", context.discussion).add(\"post\").add(\"reaction\"));\r\n        }\r\n    });\r\n\r\n    addMessageCb(\"reaction\", (path: ModelPath, data: any) => {\r\n        if (path.getId(\"post\")) {\r\n            const post = app.store.getById<Post>(\"posts\", path.getId(\"post\") as string);\r\n            if (post) {\r\n                post.pushAttributes({ reactionCounts: data.counts });\r\n                post.freshness = new Date();\r\n                m.redraw();\r\n            }\r\n        }\r\n    })\r\n}","import { extend } from \"flarum/common/extend\";\r\nimport ComposerBody from \"flarum/forum/components/ComposerBody\";\r\nimport { WebsocketHelper } from \"../../common\";\r\nimport { ModelPath } from \"../../common/Data/ModelPath\";\r\nimport app from \"flarum/forum/app\";\r\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\";\r\nimport Discussion from \"flarum/common/models/Discussion\";\r\nimport User from \"flarum/common/models/User\";\r\nimport { addMessageCb, addSubscribeCb } from \"../../common/util/frontend\";\r\nimport ItemList from \"flarum/common/utils/ItemList\";\r\nimport PostStream from \"flarum/forum/components/PostStream\";\r\nimport TypingTip from \"./components/TypingTip\";\r\nimport FieldSet from \"flarum/common/components/FieldSet\";\r\nimport Switch from \"flarum/common/components/Switch\";\r\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\r\nexport function initTypingTip() {\r\n    addMessageCb(\"typing\", (path: ModelPath, data: any) => {\r\n        const discussion = app.store.getById(\"discussions\", path.getId(\"discussion\") as string);\r\n        if (discussion) {\r\n            const typings = (discussion as any).typingUsers;\r\n            for (let i = 0; i < typings.length; i++) {\r\n                if (typings[i].id() == path.getId(\"state\")) {\r\n                    typings.splice(i, 1);\r\n                    if (!data.state) {\r\n                        m.redraw();\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            if (!data.state) {\r\n                (discussion as any).restTypingUsers--;\r\n                return;\r\n            }\r\n            typings.unshift(app.store.pushPayload<User>(data.user));\r\n            m.redraw();\r\n        }\r\n    });\r\n    addSubscribeCb(\"typing\", (items, context) => {\r\n        if (!app.forum.attribute(\"xyppWsnTypeTip\")) {\r\n            return;\r\n        }\r\n        if (context.discussion) {\r\n            items.add(\"typing\", new ModelPath().add(\"state\").add(\"discussion\", context.discussion).add(\"typing\"));\r\n        }\r\n    });\r\n    extend(ComposerBody.prototype, \"oninit\", function (this: ComposerBody, val: any) {\r\n        if (!app.forum.attribute(\"xyppWsnTypeTip\")) {\r\n            return;\r\n        }\r\n        if ((app.session?.user?.preferences() || {})[\"xyppWsnNoTypeTip\"]) {\r\n            return;\r\n        }\r\n        if ((this.attrs as any).discussion)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"discussion\", (this.attrs as any).discussion.id())\r\n                    .add(\"typing\")\r\n                );\r\n        if ((this.attrs as any).post)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"discussion\", (this.attrs as any).post.discussion().id())\r\n                    .add(\"typing\")\r\n                );\r\n    });\r\n    extend(ComposerBody.prototype, \"onbeforeremove\", function (this: ComposerBody, r: any) {\r\n        if (!app.forum.attribute(\"xyppWsnTypeTip\")) {\r\n            return;\r\n        }\r\n        if ((app.session?.user?.preferences() || {})[\"xyppWsnNoTypeTip\"]) {\r\n            return;\r\n        }\r\n        if ((this.attrs as any).discussion)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"release\")\r\n                    .add(\"discussion\", (this.attrs as any).discussion.id())\r\n                    .add(\"typing\")\r\n                );\r\n        if ((this.attrs as any).post)\r\n            WebsocketHelper.getInstance()\r\n                .state(new ModelPath()\r\n                    .add(\"state\", app.session?.user?.id())\r\n                    .add(\"release\")\r\n                    .add(\"discussion\", (this.attrs as any).post.discussion().id())\r\n                    .add(\"typing\")\r\n                );\r\n    });\r\n    extend(DiscussionPage.prototype, \"show\", function (this: DiscussionPage, r: any, discussion: Discussion) {\r\n        const typings: {\r\n            user: { data: any }[]\r\n        } = discussion.attribute(\"typeTip\");\r\n        //@ts-ignore\r\n        discussion.typingUsers = [];\r\n        for (const user of typings.user) {\r\n            if (app.session?.user?.id() == user.data.id) continue;\r\n            let u: User | undefined = app.store.getById<User>(\"users\", user.data.id);\r\n            if (!u) {\r\n                u = app.store.pushPayload<User>(user);\r\n            }\r\n            //@ts-ignore\r\n            discussion.typingUsers.push(u);\r\n        }\r\n    })\r\n    extend(PostStream.prototype, \"endItems\", function (this: PostStream, items: ItemList<any>) {\r\n        if (this.discussion.typingUsers.length)\r\n            items.add(\"typings\", TypingTip.component({\r\n                typingUsers: this.discussion.typingUsers,\r\n                key: \"typingTip\"\r\n            }));\r\n    });\r\n\r\n    extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n        items.add(\r\n            'xypp-wsn-newPostOption',\r\n            <FieldSet label={app.translator.trans(\"xypp-websocket-notification.forum.typing.title\")} className=\"Settings-typing\">\r\n                <p><Switch\r\n                    state={((app.session?.user?.preferences() || {})[\"xyppWsnNoTypeTip\"] || false)}\r\n                    onchange={(v: boolean) => {\r\n                        app.session?.user?.savePreferences({\r\n                            \"xyppWsnNoTypeTip\": v\r\n                        });\r\n                    }}\r\n                >{app.translator.trans(\"xypp-websocket-notification.forum.typing.no_type_tip\")}</Switch></p>\r\n            </FieldSet>\r\n        );\r\n    })\r\n\r\n}","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/FieldSet'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/components/Select'];","module.exports = flarum.core.compat['common/components/Switch'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/extenders'];","module.exports = flarum.core.compat['common/helpers/avatar'];","module.exports = flarum.core.compat['common/helpers/humanTime'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/helpers/username'];","module.exports = flarum.core.compat['common/models/User'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/ComposerBody'];","module.exports = flarum.core.compat['forum/components/DiscussionList'];","module.exports = flarum.core.compat['forum/components/DiscussionPage'];","module.exports = flarum.core.compat['forum/components/PostStream'];","module.exports = flarum.core.compat['forum/components/SettingsPage'];","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export { default as extend } from './src/common/extend';\nexport * from './src/forum';\nexport * from './src/common';"],"names":["ModelPath","str","nodes","data","endsWith","t","split","JSON","parse","map","n","ret","name","includes","_n$split","id","substring","length","_proto","prototype","toString","join","stringify","add","push","get","find","getId","node","remove","index","findIndex","splice","getData","setData","Extend","WebsocketAccessToken","Store","ItemList","RETRY_INTERVALS","WebsocketHelper","app","ws","statusChangeCb","context","lastSubscribes","pingInterval","nextRetry","inRetryStatus","getInstance","instance","init","start","_start","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this","item","wrap","_callee$","_context","prev","next","onclose","close","undefined","store","createRecord","save","sent","t0","retry","abrupt","WebSocket","url","clearInterval","onerror","onopen","reSubscribe","setInterval","ping","bind","onmessage","e","type","messageHandler","path","stop","apply","arguments","console","log","getSubscribes","setContext","_this2","Object","keys","forEach","v","tempContext","newSub","assign","toArray","changed","send","state","_this$app","session","user","onStatusChange","cb","_this3","setTimeout","sort","a","b","localeCompare","i","_WebsocketHelper","Model","_Model","_len","args","Array","_key","call","concat","token","attribute","replace","location","hostname","_inheritsLoose","default","showIf","judgement","vnode","def","extend","override","addSubscribeCb","addMessageCb","orig","_path$get","Component","ConnectionIndicator","_Component","currentStatus","oninit","status","view","getContent","m","className","translator","trans","redraw","initializers","window","navigation","addEventListener","event","ctr","$","addClass","appendTo","document","body","mount","component","Button","Link","ComingDiscussion","autoRefreshTimeout","autoRefresh","countdown","oncreate","_app$session","preferences","xyppWsnNewDiscussionAutoRefresh","updateCtd","onbeforeremove","attrs","list","count","href","route","near","post","title","onclick","callback","NotificationFloater","position","notifications","notification","attributes","contentType","cls","notificationComponents","first","dismiss","avatar","username","MAX_LIST_LEN","TypingTip","typingUsers","slice","u","rest","icon","humanTime","WrappedFlagNotification","flag","flags","em","discussion","createdAt","contentPlain","DiscussionPage","DiscussionList","FieldSet","SettingsPage","Switch","initDiscussionList","items","discussionList","discussionListTag","tag","getBy","comingDiscussions","toPullUpDiscussions","refresh","discussions","addDiscussion","addOne","_app$current","current","baseCount","unshift","maxLen","pop","pushPayload","idx","d","children","isArray","params","tags","r","savingList","_app$session2","_app$session4","label","onchange","_app$session3","savePreferences","value","_app$session5","preventDefault","parseInt","val","then","disabled","loading","initNotification","initPost","initLike","initTypingTip","initReaction","initOnline","initPoll","getById","like","relationships","likes","freshness","Date","Select","isAdmin","_app$session$user$unr","_app$session$user$new","model","obj","time","pushAttributes","unreadNotificationCount","newNotificationCount","_app$flags","cache","forum","flagCount","element","SELECT_FLOATER","options","wrappedFlag","User","onlineState","fn","online","flarum","extensions","hasPoll","posts","poll","polls","p","key","pollOption","voteCount","_ref","routeName","stream","viewingEnd","loadNext","removeStack","reactionCounts","counts","ComposerBody","PostStream","typings","restTypingUsers","_app$session6","_iterator","_createForOfIteratorHelperLoose","_step","done","_app$session7","_app$session8","_app$session9","_typeof","require","module","exports","__esModule","hasOwnProperty","o","defineProperty","Symbol","iterator","c","asyncIterator","toStringTag","define","enumerable","configurable","writable","Generator","create","Context","makeInvokeMethod","tryCatch","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","values","g","defineIteratorMethods","_invoke","AsyncIterator","invoke","resolve","__await","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","_sent","dispatchException","TypeError","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","setPrototypeOf","__proto__","awrap","async","Promise","reverse","charAt","rval","handle","complete","finish","_catch","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","asyncGeneratorStep","_next","_throw","_setPrototypeOf"],"sourceRoot":""}